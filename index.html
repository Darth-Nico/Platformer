<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>The Unhallowed Parish</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=MedievalSharp&display=swap" rel="stylesheet">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            background: linear-gradient(135deg, #0a0a0a 0%, #1a1a1a 100%);
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            font-family: 'MedievalSharp', cursive;
            color: #c9a959;
            position: relative;
            overflow: hidden;
        }

        .menu-container {
            background-color: rgba(0, 0, 0, 0.85);
            padding: 2rem;
            border: 2px solid #634d1d;
            box-shadow: 0 0 20px rgba(201, 169, 89, 0.2);
            text-align: center;
            max-width: 600px;
            width: 90%;
            position: relative;
        }

        h1 {
            font-size: 2.5rem;
            margin-bottom: 2rem;
            animation: glowingTitle 2s ease-in-out infinite alternate;
            letter-spacing: 2px;
            white-space: nowrap;
            color: #c9a959;
        }

        @keyframes glowingTitle {
            from {
                text-shadow: 0 0 10px rgba(201, 169, 89, 0.3),
                            0 0 20px rgba(201, 169, 89, 0.3),
                            0 0 30px rgba(201, 169, 89, 0.3);
            }
            to {
                text-shadow: 0 0 20px rgba(201, 169, 89, 0.7),
                            0 0 30px rgba(201, 169, 89, 0.7),
                            0 0 40px rgba(201, 169, 89, 0.7);
            }
        }

        .menu-items {
            display: flex;
            flex-direction: column;
            gap: 1rem;
            width: 100%;
            align-items: center;
        }

        .menu-button {
            background-color: transparent;
            border: 1px solid #634d1d;
            color: #c9a959;
            padding: 1rem 2rem;
            font-family: 'MedievalSharp', cursive;
            font-size: 1.2rem;
            cursor: pointer;
            transition: all 0.3s ease;
            text-transform: uppercase;
            letter-spacing: 1px;
            position: relative;
            overflow: hidden;
            width: 280px;
        }

        .menu-button::before {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            width: 0;
            height: 0;
            background-color: rgba(201, 169, 89, 0.1);
            transform: translate(-50%, -50%);
            border-radius: 50%;
            transition: width 0.6s, height 0.6s;
        }

        .menu-button:hover::before {
            width: 300px;
            height: 300px;
        }

        .menu-button:hover {
            border-color: #c9a959;
            text-shadow: 0 0 5px rgba(201, 169, 89, 0.5);
            transform: scale(1.02);
        }

        .menu-button:active {
            transform: scale(0.98);
        }

        .decorative-line {
            height: 2px;
            background: linear-gradient(90deg, transparent, #634d1d, transparent);
            margin: 2rem 0;
            position: relative;
        }

        .decorative-line::before {
            content: '‚ùñ';
            position: absolute;
            left: 50%;
            top: 50%;
            transform: translate(-50%, -50%);
            color: #634d1d;
            background-color: rgba(0, 0, 0, 0.85);
            padding: 0 10px;
        }

        @keyframes flicker {
            0% { opacity: 0.97; }
            50% { opacity: 1; }
            100% { opacity: 0.98; }
        }

        .menu-container {
            animation: flicker 4s infinite;
        }

        #gameScreen {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100vw;
            height: 100vh;
            background-color: #000;
            z-index: 1000;
            overflow: hidden;
        }

        #game-content {
            position: relative;
            width: 100vw;
            height: 100vh;
            z-index: 1;
        }

        #player-container {
            position: absolute;
            width: 32px;
            height: 32px;
            transform-origin: center;
            z-index: 4;
        }

        #player {
            width: 100%;
            height: 100%;
            background-color: #c9a959;
            animation: breathing 2s ease-in-out infinite;
        }

        @keyframes breathing {
            0% { transform: scale(1); }
            50% { transform: scale(1.1); }
            100% { transform: scale(1); }
        }

        #light-cone {
            position: absolute;
            top: 0;
            left: -84px;
            width: 200px;
            height: 400px;
            clip-path: polygon(
                45% 0%,
                55% 0%,
                90% 100%,
                10% 100%
            );
            background: linear-gradient(
                to bottom,
                rgba(201, 169, 89, 0.5) 0%,
                rgba(201, 169, 89, 0.4) 20%,
                rgba(201, 169, 89, 0.3) 40%,
                rgba(201, 169, 89, 0.2) 60%,
                rgba(201, 169, 89, 0.1) 80%,
                transparent 100%
            );
            transform-origin: 50% 0%;
            pointer-events: none;
            z-index: 1;
            filter: blur(12px);
        }

        .enemy-circle {
            position: absolute;
            width: 20px;
            height: 20px;
            background-color: #ff3333;
            border-radius: 50%;
            z-index: 1;
        }

        #darkness-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100vw;
            height: 100vh;
            background: #000;
            z-index: 3;
            pointer-events: none;
        }

        #light-mask {
            position: absolute;
            top: 0;
            left: -84px;
            width: 200px;
            height: 400px;
            background: radial-gradient(
                circle at 50% 0%,
                rgba(0, 0, 0, 1) 0%,
                rgba(0, 0, 0, 0.8) 40%,
                transparent 100%
            );
            transform-origin: 50% 0%;
            mix-blend-mode: destination-out;
            pointer-events: none;
            clip-path: polygon(
                45% 0%,
                55% 0%,
                90% 100%,
                10% 100%
            );
        }
    </style>
</head>
<body>
    <div class="menu-container">
        <h1>The Unhallowed Parish</h1>
        <div class="decorative-line"></div>
        <div class="menu-items">
            <button class="menu-button" onclick="startGame()">Nieuw Spel</button>
            <button class="menu-button" onclick="alert('Geen opgeslagen spel gevonden')">Doorgaan</button>
            <button class="menu-button" onclick="alert('Instellingen komen binnenkort...')">Instellingen</button>
            <button class="menu-button" onclick="alert('Gemaakt door het ontwikkelteam')">Credits</button>
            <button class="menu-button" onclick="if(confirm('Weet je zeker dat je wilt afsluiten?')) window.close()">Afsluiten</button>
        </div>
    </div>

    <div id="gameScreen">
        <div id="game-content">
            <div id="enemies"></div>
        </div>
        <div id="darkness-overlay">
            <div id="light-mask"></div>
        </div>
        <div id="player-container">
            <div id="light-cone"></div>
            <div id="player"></div>
        </div>
    </div>

    <script>
        let playerContainer;
        let playerX = 100;
        let playerY = 100;
        let playerRotation = 0;
        const SPEED = 5;
        const ROTATION_SPEED = 3;
        let keys = {};
        let enemies = [];

        function createEnemies() {
            const enemiesContainer = document.getElementById('enemies');
            for (let i = 0; i < 3; i++) {
                const enemy = document.createElement('div');
                enemy.className = 'enemy-circle';
                // Random positie binnen het scherm
                const x = Math.random() * (window.innerWidth - 20);
                const y = Math.random() * (window.innerHeight - 20);
                enemy.style.left = x + 'px';
                enemy.style.top = y + 'px';
                enemiesContainer.appendChild(enemy);
                enemies.push({
                    element: enemy,
                    x: x,
                    y: y
                });
            }
        }

        function checkEnemyVisibility() {
            const lightAngle = (playerRotation + 90) * Math.PI / 180;
            const lightRange = 400;
            const lightWidth = Math.PI / 3;

            enemies.forEach(enemy => {
                const dx = enemy.x - playerX;
                const dy = enemy.y - playerY;
                const distance = Math.sqrt(dx * dx + dy * dy);
                
                let angle = Math.atan2(dy, dx);
                if (angle < 0) angle += 2 * Math.PI;
                
                let normalizedLightAngle = lightAngle % (2 * Math.PI);
                if (normalizedLightAngle < 0) normalizedLightAngle += 2 * Math.PI;
                
                let angleDiff = Math.abs(angle - normalizedLightAngle);
                if (angleDiff > Math.PI) angleDiff = 2 * Math.PI - angleDiff;

                // Striktere check voor zichtbaarheid
                const inLightCone = distance < lightRange && 
                                  angleDiff < lightWidth / 2 &&
                                  distance > 20; // Minimale afstand tot speler

                // Bereken hoeveel van de cirkel zichtbaar moet zijn
                if (inLightCone) {
                    const visibilityAngle = (lightWidth / 2 - angleDiff) * (180 / Math.PI);
                    const visibilityPercent = Math.min(100, Math.max(0, visibilityAngle * 2));
                    enemy.element.style.clipPath = `circle(${visibilityPercent}% at center)`;
                    enemy.element.style.display = 'block';
                } else {
                    enemy.element.style.display = 'none';
                }
            });
        }

        function startGame() {
            document.querySelector('.menu-container').style.display = 'none';
            document.getElementById('gameScreen').style.display = 'block';
            playerContainer = document.getElementById('player-container');
            
            playerContainer.style.left = playerX + 'px';
            playerContainer.style.top = playerY + 'px';
            
            window.addEventListener('keydown', e => keys[e.key] = true);
            window.addEventListener('keyup', e => keys[e.key] = false);
            
            createEnemies();
            gameLoop();
        }

        function updateLightMask() {
            const lightMask = document.getElementById('light-mask');
            const darknessOverlay = document.getElementById('darkness-overlay');
            
            // Bereken positie voor het masker
            const maskX = playerX - 84; // Zelfde offset als light-cone
            const maskY = playerY;
            
            // Update masker positie en rotatie
            lightMask.style.transform = `translate(${maskX}px, ${maskY}px) rotate(${playerRotation}deg)`;
        }

        function gameLoop() {
            // Rotatie met A/D of pijltjes links/rechts
            if (keys['a'] || keys['ArrowLeft']) {
                playerRotation -= ROTATION_SPEED;
            }
            if (keys['d'] || keys['ArrowRight']) {
                playerRotation += ROTATION_SPEED;
            }

            // Vooruit/achteruit beweging in de kijkrichting
            if (keys['w'] || keys['ArrowUp']) {
                playerX += Math.cos((playerRotation + 90) * Math.PI / 180) * SPEED;
                playerY += Math.sin((playerRotation + 90) * Math.PI / 180) * SPEED;
            }
            if (keys['s'] || keys['ArrowDown']) {
                playerX -= Math.cos((playerRotation + 90) * Math.PI / 180) * SPEED;
                playerY -= Math.sin((playerRotation + 90) * Math.PI / 180) * SPEED;
            }

            // Zorg dat speler binnen het scherm blijft
            playerX = Math.max(0, Math.min(window.innerWidth - 32, playerX));
            playerY = Math.max(0, Math.min(window.innerHeight - 32, playerY));

            // Update container positie en rotatie
            playerContainer.style.left = playerX + 'px';
            playerContainer.style.top = playerY + 'px';
            playerContainer.style.transform = `rotate(${playerRotation}deg)`;

            // Update lichtmasker
            updateLightMask();

            // Check vijand zichtbaarheid
            checkEnemyVisibility();

            requestAnimationFrame(gameLoop);
        }
    </script>
</body>
</html> 